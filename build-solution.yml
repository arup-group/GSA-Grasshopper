parameters:
- name: repoRoot
  type: string
  default: ''
- name: solution
  type: string
- name: configuration
  type: string
  default: Release

steps:
- powershell: |
    dir
  displayName: 'list dir'

- task: NuGetToolInstaller@1

- task: NuGetCommand@2
  displayName: 'Restoring NuGet packages'
  inputs:
    command: 'restore'
    restoreSolution: ${{ parameters.solution }}

- task: VSBuild@1
  displayName: 'Building project in ${{ parameters.configuration }}'
  inputs:
    solution: ${{ parameters.solution }}
    msbuildArgs: '/p:AppxBundlePlatforms="x64" /p:AppxPackageDir="$(build.artifactStagingDirectory)\AppxPackages" /p:AppxBundle=Always /p:UapAppxPackageBuildMode=StoreUpload /m /nr:false /p:TreatWarningsAsErrors="true"'
    platform: 'x64'
    configuration: ${{ parameters.configuration }}
    clean: true
  env:
    MSBUILDDISABLENODEREUSE: 1
